<!DOCTYPE html>
<html>
<head>
	<title>Beschleunigungssensor-Überwachung</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<style>
		body {
			background-color: red;
		}
	</style>
</head>
<body>
	<h1>Beschleunigungssensor-Überwachung</h1>
	<button onclick="startMonitoring()">Überwachung starten</button>
	<p id="acceleration">-</p>

	<script>
		const accelerationHistory = [];

		function startMonitoring() {
			if (typeof DeviceMotionEvent.requestPermission === 'function') {
				// Zustimmung des Benutzers einholen, um auf Beschleunigungssensoren zuzugreifen
				DeviceMotionEvent.requestPermission().then(response => {
					if (response == 'granted') {
						// Ereignislistener hinzufügen, um Bewegungen des Geräts zu überwachen
						window.addEventListener('devicemotion', handleMotionEvent);
					}
				}).catch(console.error);
			} else {
				// Das Gerät unterstützt keine Zustimmungserklärung, daher einfach Ereignislistener hinzufügen
				window.addEventListener('devicemotion', handleMotionEvent);
			}
		}

		function handleMotionEvent(event) {
			// Schwellenwert für Bewegungserkennung festlegen
			const threshold = 10;

			// Beschleunigungsdaten des Geräts aus dem Event-Objekt abrufen
			const { x, y, z } = event.accelerationIncludingGravity;

			// Erdbeschleunigung abziehen
			const g = 9.81;
			const acceleration = z - g;

			if (acceleration > threshold) {
				// Das Gerät wird geschüttelt, fügen Sie hier den Code ein, den Sie ausführen möchten.
				console.log('Gerät wird geschüttelt!');
				document.body.style.backgroundColor = 'green';
			} else {
				document.body.style.backgroundColor = 'red';
			}

			// Durchschnittliche Beschleunigung der letzten Sekunde berechnen und anzeigen
			accelerationHistory.push(acceleration);
			const now = Date.now();
			const lastSecond = now - 1000;
			const lastSecondAccelerations = accelerationHistory.filter(a => a.timestamp >= lastSecond);
			const averageAcceleration = lastSecondAccelerations.reduce((sum, a) => sum + a, 0) / lastSecondAccelerations.length;
			document.getElementById('acceleration').textContent = `Durchschnittliche Beschleunigung: ${averageAcceleration.toFixed(2)} m/s²`;
		}
	</script>
</body>
</html>
