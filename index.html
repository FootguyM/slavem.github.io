<!DOCTYPE html>
<html>
<head>
	<title>Beschleunigungssensor-Überwachung</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<style>
		body {
			background-color: red;
		}

		.shake {
			background-color: green;
		}

		.acceleration {
			font-size: 24px;
			font-weight: bold;
			margin-top: 20px;
		}
	</style>
</head>
<body>
	<button onclick="startMonitoring()">Überwachung starten</button>
	<div class="acceleration">-</div>

	<script>
		function startMonitoring() {
			if (typeof DeviceMotionEvent.requestPermission === 'function') {
				// Zustimmung des Benutzers einholen, um auf Beschleunigungssensoren zuzugreifen
				DeviceMotionEvent.requestPermission().then(response => {
					if (response == 'granted') {
						// Ereignislistener hinzufügen, um Bewegungen des Geräts zu überwachen
						window.addEventListener('devicemotion', handleMotionEvent);
					}
				}).catch(console.error);
			} else {
				// Das Gerät unterstützt keine Zustimmungserklärung, daher einfach Ereignislistener hinzufügen
				window.addEventListener('devicemotion', handleMotionEvent);
			}
		}

		let samples = [];

		function handleMotionEvent(event) {
			// Schwellenwert für Bewegungserkennung festlegen
			const threshold = 1;

			// Beschleunigungsdaten des Geräts aus dem Event-Objekt abrufen
			const { x, y, z } = event.accelerationIncludingGravity;

			// Berechnen Sie die Gesamtbeschleunigung des Geräts
			const acceleration = Math.sqrt(x * x + y * y + z * z);

			// Erdbeschleunigung entfernen
			const gravity = 9.81;
			const zAcceleration = z - gravity;

			// Samples hinzufügen und älteste entfernen
			const sample = {
				value: zAcceleration,
				timestamp: Date.now()
			};

			samples.push(sample);
			const oldestSample = samples[0];

			if (oldestSample.timestamp < (Date.now() - 1000)) {
				samples.shift();
			}

			// Durchschnittliche Beschleunigung der letzten Sekunde berechnen
			const sum = samples.reduce((total, sample) => total + sample.value, 0);
			const averageAcceleration = sum / samples.length;

			// Ausgabe der Beschleunigung auf der Webseite
			const accelerationElement = document.querySelector('.acceleration');
			accelerationElement.textContent = `Beschleunigung: ${averageAcceleration.toFixed(2)} m/s^2`;

			if (averageAcceleration > threshold) {
				// Das Gerät wird geschüttelt, Hintergrundfarbe ändern und CSS-Klasse hinzufügen
				document.body.classList.add('shake');
			} else {
				// Das
